var q=Object.defineProperty;var E=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var G=(r,t,s)=>t in r?q(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,v=(r,t)=>{for(var s in t||(t={}))J.call(t,s)&&G(r,s,t[s]);if(E)for(var s of E(t))_.call(t,s)&&G(r,s,t[s]);return r};var N=(r,t,s)=>new Promise((l,n)=>{var d=i=>{try{h(s.next(i))}catch(u){n(u)}},m=i=>{try{h(s.throw(i))}catch(u){n(u)}},h=i=>i.done?l(i.value):Promise.resolve(i.value).then(d,m);h((s=s.apply(r,t)).next())});import{u as $,j as e}from"./index-220525ce.js";import{r as c}from"./vendor-146ef102.js";import{g as j,u as O,H as P,R as X,J as ee,N as se,o as te,n as ae,F as B,T as L,Z as Q,M as w,S as re,C as le}from"./icons-521df13f.js";import"./utils-d9662bcb.js";const ne=()=>{const{api:r,settings:t}=$(),[s,l]=c.useState([]),[n,d]=c.useState(""),[m,h]=c.useState(!1),[i,u]=c.useState("gpt-4o-mini"),[x,f]=c.useState(!0),[D,C]=c.useState(null),S=c.useRef(null),A=c.useRef(null),k=c.useRef(null),[R,z]=c.useState(!0),[M,U]=c.useState(0);c.useEffect(()=>{if(s.length>M&&R){const a=s[s.length-1];a&&(a.type==="assistant"||s.length===1)&&W()}U(s.length)},[s,R,M]);const W=()=>{setTimeout(()=>{var a;(a=S.current)==null||a.scrollIntoView({behavior:"smooth"})},100)};c.useEffect(()=>{T()},[]);const F=()=>{const a=k.current;if(a){const{scrollTop:o,scrollHeight:p,clientHeight:y}=a,Z=o+y>=p-50;z(Z)}},T=()=>{const a={id:g(),type:"assistant",content:"ðŸ‘‹ Hi! I'm your AutoLlama AI assistant. I can help you search and understand your processed documents using advanced RAG (Retrieval-Augmented Generation). What would you like to know?",timestamp:new Date,sources:[]};l([a]),C(g())},I=()=>N(void 0,null,function*(){if(!n.trim()||m)return;const a={id:g(),type:"user",content:n.trim(),timestamp:new Date};l(o=>[...o,a]),d(""),h(!0),setTimeout(()=>{var o;(o=A.current)==null||o.focus()},50);try{const o=yield r.chat.sendMessage({message:n.trim(),model:i,ragEnabled:x,conversationId:D,systemContext:"You are AutoLlama's AI assistant. Use the knowledge base to provide helpful, accurate responses with source citations."}),p={id:g(),type:"assistant",content:o.content||o.message||"I apologize, but I encountered an issue processing your request.",timestamp:new Date,sources:o.sources||[],metadata:o.metadata||{}};l(y=>[...y,p])}catch(o){const p={id:g(),type:"assistant",content:`I encountered an error: ${o.message||"Unable to process your request"}. Please try again or check your connection settings.`,timestamp:new Date,isError:!0};l(y=>[...y,p])}finally{h(!1)}}),K=a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),a.stopPropagation(),I())},H=a=>{a.preventDefault(),a.stopPropagation(),I()},V=()=>{l([]),C(g()),T()},Y=a=>{navigator.clipboard.writeText(a)},g=()=>Math.random().toString(36).substr(2,9);return e.jsxs("div",{className:"flex flex-col h-full max-h-[80vh] bg-gray-900 rounded-xl border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800 bg-opacity-50 rounded-t-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-600 bg-opacity-20 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white",children:"AutoLlama Chat"}),e.jsx("p",{className:"text-sm text-gray-400",children:"RAG-powered AI assistant â€¢ Connected to your knowledge base"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"RAG:"}),e.jsx("button",{onClick:()=>f(!x),className:`relative w-10 h-6 rounded-full transition-colors ${x?"bg-primary-600":"bg-gray-600"}`,children:e.jsx("div",{className:`absolute w-4 h-4 bg-white rounded-full top-1 transition-transform ${x?"translate-x-5":"translate-x-1"}`})})]}),e.jsxs("select",{value:i,onChange:a=>u(a.target.value),className:"bg-gray-700 border border-gray-600 rounded-md px-3 py-1 text-sm text-white",children:[e.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini"}),e.jsx("option",{value:"gpt-4o",children:"GPT-4o"}),e.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]}),e.jsx("button",{onClick:V,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",title:"Clear conversation",children:e.jsx(O,{className:"w-4 h-4 text-gray-400"})})]})]}),e.jsxs("div",{ref:k,onScroll:F,className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[s.map(a=>e.jsx(ce,{message:a,onCopy:()=>Y(a.content)},a.id)),m&&e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-600 bg-opacity-20 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"w-4 h-4 text-primary-400"})}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(X,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"AutoLlama is thinking..."})]})]}),e.jsx("div",{ref:S})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-800 bg-opacity-30 rounded-b-xl",children:[e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("textarea",{ref:A,value:n,onChange:a=>d(a.target.value),onKeyPress:K,placeholder:"Ask me anything about your processed documents...",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:Math.min(Math.max(n.split(`
`).length,1),4),disabled:m})}),e.jsx("button",{onClick:H,disabled:!n.trim()||m,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",type:"button",children:e.jsx(ee,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[e.jsx("span",{children:"Press Enter to send, Shift+Enter for new line"}),e.jsxs("span",{className:`flex items-center gap-1 ${x?"text-green-400":"text-gray-500"}`,children:[e.jsx(j,{className:"w-3 h-3"}),x?"RAG Active":"RAG Disabled"]})]})]})]})},ce=({message:r,onCopy:t})=>{const s=r.type==="user",l=r.isError;return e.jsxs("div",{className:`flex gap-3 ${s?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${s?"bg-blue-600 bg-opacity-20":l?"bg-red-600 bg-opacity-20":"bg-primary-600 bg-opacity-20"}`,children:s?e.jsx(se,{className:"w-4 h-4 text-blue-400"}):e.jsx(P,{className:`w-4 h-4 ${l?"text-red-400":"text-primary-400"}`})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${s?"text-right":"text-left"}`,children:[e.jsxs("div",{className:`inline-block p-4 rounded-2xl ${s?"bg-blue-600 bg-opacity-20 text-blue-100":l?"bg-red-600 bg-opacity-20 text-red-100 border border-red-500 border-opacity-30":"bg-gray-800 bg-opacity-50 text-gray-100"}`,children:[e.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:r.content}),r.sources&&r.sources.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600 border-opacity-50",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Sources:"}),e.jsx("div",{className:"space-y-1",children:r.sources.map((n,d)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(te,{className:"w-3 h-3 text-gray-400"}),e.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline truncate max-w-xs",children:n.title||n.url}),n.score&&e.jsxs("span",{className:"text-gray-500",children:["(",Math.round(n.score*100),"%)"]})]},d))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-gray-500",children:[e.jsx("span",{children:r.timestamp.toLocaleTimeString()}),e.jsx("button",{onClick:t,className:"hover:text-gray-300 transition-colors",title:"Copy message",children:e.jsx(ae,{className:"w-3 h-3"})})]})]})]})},ie=ne,oe=()=>{const{api:r,documents:t,systemStats:s}=$(),[l,n]=c.useState({totalQueries:0,averageResponseTime:0,knowledgeBaseSize:0,ragAccuracy:0}),[d,m]=c.useState(!0);c.useEffect(()=>{h()},[]);const h=()=>N(void 0,null,function*(){try{const x=yield r.chat.getStats();n(f=>v(v({},f),x))}catch(x){n({totalQueries:0,averageResponseTime:1.2,knowledgeBaseSize:(t==null?void 0:t.length)||0,ragAccuracy:92})}}),i=["Summarize the main points from my recent uploads","What topics do I have the most content about?","Find information about machine learning in my documents","What are the key insights from my research papers?","Show me content related to AI and automation"],u=x=>{m(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(b,{title:"Knowledge Base",value:`${l.knowledgeBaseSize||(t==null?void 0:t.length)||0} docs`,icon:B,color:"text-blue-400",description:"Processed documents"}),e.jsx(b,{title:"RAG Accuracy",value:`${l.ragAccuracy||92}%`,icon:L,color:"text-green-400",description:"Answer relevance"}),e.jsx(b,{title:"Response Time",value:`${l.averageResponseTime||1.2}s`,icon:Q,color:"text-yellow-400",description:"Average speed"}),e.jsx(b,{title:"Total Queries",value:l.totalQueries||0,icon:w,color:"text-purple-400",description:"Chat sessions"})]}),d?e.jsx(de,{sampleQuestions:i,onQuestionSelect:u,onStartChat:()=>m(!1),knowledgeBaseSize:(t==null?void 0:t.length)||0}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(ie,{})}),e.jsx("div",{className:"space-y-4",children:e.jsx(xe,{documents:t,onQuestionSelect:u,sampleQuestions:i})})]})]})},de=({sampleQuestions:r,onQuestionSelect:t,onStartChat:s,knowledgeBaseSize:l})=>e.jsxs("div",{className:"card text-center space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-primary-600 bg-opacity-20 rounded-full flex items-center justify-center mx-auto",children:e.jsx(j,{className:"w-10 h-10 text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"AutoLlama RAG Chat"}),e.jsx("p",{className:"text-xl text-gray-400",children:"Your AI assistant powered by your processed documents"})]})]}),e.jsxs("div",{className:"bg-gray-800 bg-opacity-50 rounded-lg p-6 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(B,{className:"w-6 h-6 text-blue-400"}),e.jsx("span",{className:"text-lg font-medium",children:"Knowledge Base Ready"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:l}),e.jsx("div",{className:"text-gray-400",children:"Documents"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:"RAG"}),e.jsx("div",{className:"text-gray-400",children:"Enhanced"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:"GPT-4o"}),e.jsx("div",{className:"text-gray-400",children:"Powered"})]})]})]}),e.jsxs("div",{className:"space-y-4 max-w-3xl mx-auto",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-300",children:"Try asking about:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map((n,d)=>e.jsx("button",{onClick:()=>t(n),className:"p-4 bg-gray-800 bg-opacity-50 rounded-lg border border-gray-700 hover:border-primary-500 hover:bg-primary-600 hover:bg-opacity-10 transition-all text-left group",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(w,{className:"w-5 h-5 text-gray-400 group-hover:text-primary-400 mt-1 flex-shrink-0"}),e.jsxs("span",{className:"text-gray-300 group-hover:text-white text-sm",children:['"',n,'"']})]})},d))})]}),e.jsxs("button",{onClick:s,className:"btn-primary text-lg px-8 py-3",children:[e.jsx(w,{className:"w-5 h-5"}),"Start Chatting"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto text-sm",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(re,{className:"w-8 h-8 text-blue-400 mx-auto"}),e.jsx("h4",{className:"font-bold text-white",children:"Semantic Search"}),e.jsx("p",{className:"text-gray-400",children:"Find relevant information across all your documents using advanced vector search"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(j,{className:"w-8 h-8 text-green-400 mx-auto"}),e.jsx("h4",{className:"font-bold text-white",children:"Context-Aware"}),e.jsx("p",{className:"text-gray-400",children:"Responses include contextual understanding of your document relationships"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(L,{className:"w-8 h-8 text-purple-400 mx-auto"}),e.jsx("h4",{className:"font-bold text-white",children:"Source Citations"}),e.jsx("p",{className:"text-gray-400",children:"Every answer includes links to the source documents for verification"})]})]})]}),xe=({documents:r,onQuestionSelect:t,sampleQuestions:s})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"font-bold mb-3 flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-yellow-400"}),"Quick Questions"]}),e.jsx("div",{className:"space-y-2",children:s.slice(0,3).map((l,n)=>e.jsxs("button",{onClick:()=>t(l),className:"w-full text-left p-2 text-sm bg-gray-800 bg-opacity-50 rounded-md hover:bg-gray-700 transition-colors",children:['"',l.substring(0,50),'..."']},n))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"font-bold mb-3 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-blue-400"}),"Recent Documents"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto custom-scrollbar",children:r==null?void 0:r.slice(0,5).map((l,n)=>e.jsxs("div",{className:"p-2 bg-gray-800 bg-opacity-30 rounded-md",children:[e.jsx("div",{className:"font-medium text-white text-sm truncate",children:l.title||l.url||"Untitled"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.chunkCount||0," chunks â€¢ ",l.contentType||"document"]})]},n))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"font-bold mb-3 flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-primary-400"}),"RAG Features"]}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsx("span",{children:"Contextual embeddings active"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{children:"Vector similarity search"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full"}),e.jsx("span",{children:"Source citation included"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{children:"Real-time knowledge base"})]})]})]})]}),b=({title:r,value:t,icon:s,color:l,description:n})=>e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(s,{className:`w-6 h-6 ${l}`})}),e.jsx("div",{className:`text-2xl font-bold ${l} mb-1`,children:t}),e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:r}),e.jsx("div",{className:"text-xs text-gray-500",children:n})]}),ye=oe;export{ie as ChatInterface,ye as RAGChat,ye as default};
