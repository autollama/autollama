var he=Object.defineProperty,pe=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var le=(o,t,r)=>t in o?he(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,S=(o,t)=>{for(var r in t||(t={}))ue.call(t,r)&&le(o,r,t[r]);if(ne)for(var r of ne(t))je.call(t,r)&&le(o,r,t[r]);return o},T=(o,t)=>pe(o,ge(t));var M=(o,t,r)=>new Promise((u,a)=>{var y=i=>{try{N(r.next(i))}catch(w){a(w)}},c=i=>{try{N(r.throw(i))}catch(w){a(w)}},N=i=>i.done?u(i.value):Promise.resolve(i.value).then(y,c);N((r=r.apply(o,t)).next())});import{u as K,j as e,s as Z,b as ye}from"./index-220525ce.js";import{r as p}from"./vendor-146ef102.js";import{W as de,R,k as be,E as me,b as U,A as F,K as Ne,g as q,S as ve,Z as W,l as ie,D as G,m as fe,j as we,a as Y,n as X,o as Ce,p as ke,q as Se,r as Te,e as Pe,C as xe,s as ce,t as J,P as Ae,U as te,X as ae,u as Ie,v as Me,w as De}from"./icons-521df13f.js";import"./utils-d9662bcb.js";const Ue=({onSettingsChange:o})=>{const{settings:t,connectionStatus:r,updateCategory:u}=K(),[a,y]=p.useState(t.connections),[c,N]=p.useState({}),[i,w]=p.useState({all:!1}),[x,D]=p.useState({}),[j,P]=p.useState(!0),[A,b]=p.useState(!1);p.useEffect(()=>{(()=>M(void 0,null,function*(){try{P(!0);const g=yield Z.loadSettingsFromDatabase();y(g.connections),u("connections",g.connections)}catch(g){y(t.connections)}finally{P(!1)}}))()},[]),p.useEffect(()=>{j||y(t.connections)},[t.connections,j]);const d=(s,g)=>M(void 0,null,function*(){const m=T(S({},a),{[s]:g});y(m),u("connections",m),o(),b(!0);try{yield Z.saveConnectionsToDatabase(m)}catch(E){}finally{setTimeout(()=>b(!1),500)}}),k=s=>{N(g=>T(S({},g),{[s]:!g[s]}))},C=()=>M(void 0,null,function*(){w(s=>T(S({},s),{all:!0}));try{const s={connections:a},g=yield Z.validateConnections(s);D(g)}catch(s){D({openai:!1,qdrant:!1})}finally{w(s=>T(S({},s),{all:!1}))}}),I=s=>{const g=r[s],m=x[s];return i.all?e.jsx(R,{className:"w-4 h-4 text-yellow-400 animate-spin"}):m!==void 0?m?e.jsx(U,{className:"w-4 h-4 text-green-400"}):e.jsx(F,{className:"w-4 h-4 text-red-400"}):g?e.jsx(U,{className:"w-4 h-4 text-green-400"}):e.jsx(F,{className:"w-4 h-4 text-gray-400"})},O=[{id:"openai",title:"OpenAI API",description:"GPT models for AI analysis and contextual embeddings",icon:q,fields:[{key:"openaiApiKey",label:"API Key",type:"password",placeholder:"sk-proj-...",required:!0,help:"Get your API key from https://platform.openai.com/api-keys"}]},{id:"qdrant",title:"Qdrant Vector Database",description:"Semantic search and vector embeddings storage",icon:ve,fields:[{key:"qdrantUrl",label:"Cluster URL",type:"url",placeholder:"https://your-cluster.qdrant.io",required:!0,help:"Your Qdrant cluster URL from the cloud dashboard"},{key:"qdrantApiKey",label:"API Key",type:"password",placeholder:"Enter your Qdrant API key",required:!0,help:"API key for your Qdrant cluster"}]}];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(de,{className:"w-6 h-6 text-primary-400"}),"Connection Settings",A&&e.jsxs("span",{className:"text-sm text-yellow-400 flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3 animate-spin"}),"Saving..."]})]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Configure OpenAI and Qdrant connections for AutoLlama services"})]}),e.jsxs("button",{onClick:C,disabled:i.all,className:"btn-primary",children:[e.jsx(R,{className:`w-4 h-4 ${i.all?"animate-spin":""}`}),i.all?"Testing...":"Test All"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(re,{title:"OpenAI",status:r.openai,testResult:x.openai,testing:i}),e.jsx(re,{title:"Qdrant",status:r.qdrant,testResult:x.qdrant,testing:i})]}),j&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[e.jsx(R,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Loading connection settings..."})]})}),!j&&e.jsx("div",{className:"space-y-6",children:O.map(s=>{const g=s.icon;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-600 bg-opacity-20 rounded-lg flex items-center justify-center",children:e.jsx(g,{className:"w-5 h-5 text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-400",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[I(s.id),e.jsx("span",{className:"text-sm text-gray-400",children:r[s.id]?"Connected":"Disconnected"})]})]}),e.jsx("div",{className:"space-y-4",children:s.fields.map(m=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:[m.label,m.required&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:m.type==="password"&&!c[m.key]?"password":"text",value:a[m.key]||"",onChange:E=>d(m.key,E.target.value),placeholder:m.placeholder,className:"input-primary pr-12",required:m.required}),m.type==="password"&&e.jsx("button",{type:"button",onClick:()=>k(m.key),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:c[m.key]?e.jsx(be,{className:"w-4 h-4"}):e.jsx(me,{className:"w-4 h-4"})})]})}),m.help&&e.jsx("p",{className:"text-xs text-gray-500",children:m.help})]},m.key))}),x[s.id]!==void 0&&e.jsx("div",{className:`mt-4 p-3 rounded-lg border ${x[s.id]?"bg-green-900 bg-opacity-20 border-green-700 text-green-300":"bg-red-900 bg-opacity-20 border-red-700 text-red-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[x[s.id]?e.jsx(U,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:x[s.id]?`${s.title} connection successful`:`${s.title} connection failed`})]})})]},s.id)})}),!j&&e.jsx("div",{className:"card bg-yellow-900 bg-opacity-20 border-yellow-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-yellow-400 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-yellow-300 mb-2",children:"Security Notice"}),e.jsxs("div",{className:"text-sm text-yellow-200 space-y-1",children:[e.jsx("p",{children:"• API keys are stored securely in the database and synchronized with environment variables"}),e.jsx("p",{children:"• Keys are never transmitted to external servers except their respective APIs"}),e.jsx("p",{children:"• Changes take effect immediately and are automatically saved"}),e.jsx("p",{children:"• Regularly rotate your API keys for enhanced security"})]})]})]})})]})},re=({title:o,status:t,testResult:r,testing:u})=>{const a=()=>u.all?"border-yellow-500 text-yellow-400":r!==void 0?r?"border-green-500 text-green-400":"border-red-500 text-red-400":t?"border-green-500 text-green-400":"border-gray-500 text-gray-400",y=()=>u.all?e.jsx(R,{className:"w-4 h-4 animate-spin"}):r!==void 0?r?e.jsx(U,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}):t?e.jsx(U,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}),c=()=>u.all?"Testing...":r!==void 0?r?"Connected":"Failed":t?"Connected":"Offline";return e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-colors ${a()}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:o}),y()]}),e.jsx("div",{className:"text-sm opacity-80",children:c()})]})},oe=Ue,Ee=({onSettingsChange:o})=>{var n,h;const{settings:t,updateCategory:r,api:u}=K(),[a,y]=p.useState(t.pipeline),[c,N]=p.useState({}),[i,w]=p.useState(!1),[x,D]=p.useState(null),[j,P]=p.useState(null),[A,b]=p.useState({}),[d,k]=p.useState(!1);p.useEffect(()=>{y(t.pipeline),I(),O()},[t.pipeline]);const C=((n=t.connections)==null?void 0:n.claudeApiKey)&&t.connections.claudeApiKey.trim().length>0,I=()=>M(void 0,null,function*(){try{const l=yield u.stats.getPipelineHealth();P(l)}catch(l){}}),O=()=>M(void 0,null,function*(){try{const l=yield u.getRagSettings();N(l.data.settings||{})}catch(l){N({ragModel:"gpt-4o-mini",ragMaxTokens:1e3,ragTemperature:.7,searchLimit:5})}}),s=l=>M(void 0,null,function*(){k(!0);try{const v=yield u.updateRagSettings(l);N(v.data.settings||l)}catch(v){}finally{k(!1)}}),g=(l,v)=>{const f=T(S({},a),{[l]:v});y(f),r("pipeline",f),o()},m=(l,v)=>{const f=T(S({},c),{[l]:v});N(f),m.timeout&&clearTimeout(m.timeout),m.timeout=setTimeout(()=>{s(f)},1e3)},E=()=>M(void 0,null,function*(){w(!0);try{const l=yield u.stats.getPipelineHealth();D({success:!0,message:"Pipeline connection successful",details:l})}catch(l){D({success:!1,message:"Pipeline connection failed",error:l.message})}finally{w(!1)}}),L=(l,v)=>{navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(l).then(()=>{b(f=>T(S({},f),{[v]:!0})),setTimeout(()=>b(f=>T(S({},f),{[v]:!1})),2e3)}).catch(()=>{$(l,v)}):$(l,v)},$=(l,v)=>{const f=document.createElement("textarea");f.value=l,f.style.top="0",f.style.left="0",f.style.position="fixed",document.body.appendChild(f),f.focus(),f.select();try{document.execCommand("copy"),b(_=>T(S({},_),{[v]:!0})),setTimeout(()=>b(_=>T(S({},_),{[v]:!1})),2e3)}catch(_){}document.body.removeChild(f)},z=()=>"http://autollama-on-hstgr:3001/api/openwebui",B=()=>["http://autollama-on-hstgr-4:3001/api/openwebui","http://localhost:9099","https://autollama.io:9099"];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(W,{className:"w-6 h-6 text-primary-400"}),"OpenWebUI Pipeline"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Configure RAG pipeline for intelligent conversations with your processed content"})]}),e.jsxs("button",{onClick:E,disabled:i,className:"btn-primary",children:[e.jsx(ie,{className:`w-4 h-4 ${i?"animate-spin":""}`}),i?"Testing...":"Test Pipeline"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(ee,{title:"Pipeline Status",status:(x==null?void 0:x.success)||(j==null?void 0:j.status)||(j?"Ready":null),icon:W,description:"OpenWebUI service connectivity"}),e.jsx(ee,{title:"Collection",status:a.collectionName,icon:G,description:"Qdrant collection name"}),e.jsx(ee,{title:"Debug Mode",status:a.debugMode,icon:ie,description:"Detailed logging enabled"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-primary-400"}),"Connection Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:["Pipeline URL",e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("input",{type:"url",value:a.pipelineUrl,onChange:l=>g("pipelineUrl",l.target.value),placeholder:"http://autollama-on-hstgr:3001/api/openwebui",className:"input-primary",required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"URL where the OpenWebUI pipeline service is running"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:["API Key",e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("input",{type:"text",value:a.apiKey,onChange:l=>g("apiKey",l.target.value),placeholder:"0p3n-w3bu!",className:"input-primary font-mono",required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Authentication key for pipeline access"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:["Collection Name",e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("input",{type:"text",value:a.collectionName,onChange:l=>g("collectionName",l.target.value),placeholder:"autollama-content",className:"input-primary font-mono",required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Qdrant collection to search for RAG operations"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Max Results"}),e.jsx("input",{type:"number",min:"1",max:"50",value:a.maxResults,onChange:l=>g("maxResults",parseInt(l.target.value)),className:"input-primary"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Maximum number of results to return per search"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-primary-400"}),"Search & Retrieval Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Similarity Threshold"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"0.1",max:"1.0",step:"0.1",value:a.similarityThreshold,onChange:l=>g("similarityThreshold",parseFloat(l.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded",children:a.similarityThreshold.toFixed(1)})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Minimum similarity score for results (0.1 = loose, 1.0 = strict)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:a.debugMode,onChange:l=>g("debugMode",l.target.checked),className:"rounded"}),"Debug Mode"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Enable detailed logging for troubleshooting pipeline issues"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h4",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-primary-400"}),"RAG Model Configuration"]}),d&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-400",children:[e.jsx(R,{className:"w-4 h-4 animate-spin"}),"Saving settings..."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:["Language Model",e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsxs("select",{value:c.ragModel||"gpt-4o-mini",onChange:l=>m("ragModel",l.target.value),className:"input-primary",disabled:d,children:[e.jsxs("optgroup",{label:"OpenAI Models",children:[e.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini (Fast & Cost-Effective)"}),e.jsx("option",{value:"gpt-4o",children:"GPT-4o (Most Capable)"}),e.jsx("option",{value:"gpt-4",children:"GPT-4 (Flagship Model)"}),e.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo (Budget)"})]}),C&&e.jsxs("optgroup",{label:"Anthropic Models",children:[e.jsx("option",{value:"claude-3-5-sonnet-20241022",children:"Claude 3.5 Sonnet (Most Capable)"}),e.jsx("option",{value:"claude-3-5-haiku-20241022",children:"Claude 3.5 Haiku (Fast & Efficient)"}),e.jsx("option",{value:"claude-3-opus-20240229",children:"Claude 3 Opus (Creative & Complex)"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Language model used to interpret and synthesize RAG search results"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Max Tokens"}),e.jsx("input",{type:"number",min:"100",max:"4000",value:c.ragMaxTokens||1e3,onChange:l=>m("ragMaxTokens",parseInt(l.target.value)),className:"input-primary",disabled:d}),e.jsx("p",{className:"text-xs text-gray-500",children:"Maximum tokens for RAG model responses"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Temperature"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"0.0",max:"1.0",step:"0.1",value:c.ragTemperature||.7,onChange:l=>m("ragTemperature",parseFloat(l.target.value)),className:"flex-1",disabled:d}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded",children:(c.ragTemperature||.7).toFixed(1)})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Creativity level (0.0 = focused, 1.0 = creative)"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 bg-opacity-50 rounded-lg border border-gray-700",children:[e.jsx("h5",{className:"font-medium text-gray-300 mb-3",children:"Model Comparison"}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 ${C?"lg:grid-cols-4 xl:grid-cols-7":"lg:grid-cols-4"} gap-4 text-xs`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-blue-400",children:"GPT-4o Mini"}),e.jsx("div",{className:"text-gray-500",children:"Fast, cost-effective"}),e.jsx("div",{className:"text-gray-500",children:"Best for most RAG tasks"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-purple-400",children:"GPT-4o"}),e.jsx("div",{className:"text-gray-500",children:"Most capable"}),e.jsx("div",{className:"text-gray-500",children:"Complex reasoning"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-green-400",children:"GPT-4"}),e.jsx("div",{className:"text-gray-500",children:"Flagship model"}),e.jsx("div",{className:"text-gray-500",children:"Proven reliability"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-yellow-400",children:"GPT-3.5 Turbo"}),e.jsx("div",{className:"text-gray-500",children:"Budget option"}),e.jsx("div",{className:"text-gray-500",children:"Faster responses"})]}),C&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-orange-400",children:"Claude 3.5 Sonnet"}),e.jsx("div",{className:"text-gray-500",children:"Superior reasoning"}),e.jsx("div",{className:"text-gray-500",children:"Excellent for analysis"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-cyan-400",children:"Claude 3.5 Haiku"}),e.jsx("div",{className:"text-gray-500",children:"Fast, efficient"}),e.jsx("div",{className:"text-gray-500",children:"Cost-effective choice"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium text-indigo-400",children:"Claude 3 Opus"}),e.jsx("div",{className:"text-gray-500",children:"Most creative"}),e.jsx("div",{className:"text-gray-500",children:"Complex tasks"})]})]})]})]})]}),x&&e.jsx("div",{className:`card ${x.success?"bg-green-900 bg-opacity-20 border-green-700":"bg-red-900 bg-opacity-20 border-red-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[x.success?e.jsx(U,{className:"w-5 h-5 text-green-400 mt-1"}):e.jsx(F,{className:"w-5 h-5 text-red-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-bold mb-2 ${x.success?"text-green-300":"text-red-300"}`,children:x.message}),x.success&&x.details&&e.jsxs("div",{className:"text-sm text-green-200 space-y-1",children:[e.jsxs("p",{children:["• Pipeline Version: ",x.details.version||"Unknown"]}),e.jsxs("p",{children:["• Response Time: ",x.details.responseTime||"N/A","ms"]}),e.jsxs("p",{children:["• Collections Available: ",((h=x.details.collections)==null?void 0:h.length)||0]})]}),!x.success&&x.error&&e.jsxs("div",{className:"text-sm text-red-200",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Error:"})," ",x.error]}),e.jsxs("div",{className:"mt-2 text-xs",children:[e.jsx("p",{children:e.jsx("strong",{children:"Troubleshooting:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Verify the pipeline URL is correct and accessible"}),e.jsx("li",{children:"Check that the OpenWebUI service is running"}),e.jsx("li",{children:"Ensure the API key matches the pipeline configuration"}),e.jsx("li",{children:"Confirm network connectivity between services"})]})]})]})]})]})}),j&&e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-primary-400"}),"Pipeline Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(H,{label:"Total Queries",value:j.totalQueries||0}),e.jsx(H,{label:"Avg Response Time",value:`${j.avgResponseTime||0}ms`}),e.jsx(H,{label:"Cache Hit Rate",value:`${j.cacheHitRate||0}%`}),e.jsx(H,{label:"Uptime",value:j.uptime||"0h"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"card bg-green-900 bg-opacity-20 border-green-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Y,{className:"w-5 h-5 text-green-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-green-300 mb-3",children:"✨ OpenWebUI Integration - Ready!"}),e.jsxs("div",{className:"text-sm text-green-200 space-y-3",children:[e.jsx("p",{children:"AutoLlama RAG pipeline is built-in and running automatically. No additional services needed!"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-800 bg-opacity-30 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-green-300",children:"Pipeline URL"}),e.jsx("button",{onClick:()=>L(z(),"url"),className:"p-1 hover:bg-green-700 rounded transition-colors",title:"Copy URL",children:A.url?e.jsx(U,{className:"w-4 h-4 text-green-300"}):e.jsx(X,{className:"w-4 h-4 text-green-400"})})]}),e.jsx("code",{className:"text-green-100 text-sm break-all",children:z()})]}),e.jsxs("div",{className:"bg-green-800 bg-opacity-30 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-green-300",children:"API Key"}),e.jsx("button",{onClick:()=>L(a.apiKey,"apikey"),className:"p-1 hover:bg-green-700 rounded transition-colors",title:"Copy API Key",children:A.apikey?e.jsx(U,{className:"w-4 h-4 text-green-300"}):e.jsx(X,{className:"w-4 h-4 text-green-400"})})]}),e.jsx("code",{className:"text-green-100 text-sm",children:a.apiKey})]})]})]})]})]})}),e.jsx("div",{className:"card bg-blue-900 bg-opacity-20 border-blue-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-blue-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-blue-300 mb-3",children:"📋 Step-by-Step Setup Guide"}),e.jsxs("div",{className:"text-sm text-blue-200 space-y-4",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-blue-300 mb-2",children:"In OpenWebUI:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 ml-2",children:[e.jsxs("li",{children:["Go to ",e.jsx("span",{className:"font-semibold",children:"Admin Panel → Settings → Connections"})]}),e.jsxs("li",{children:["Click ",e.jsx("span",{className:"font-semibold",children:'"Add OpenAI API Connection"'})]}),e.jsx("li",{children:"Enter the configuration from the boxes above ⬆️"}),e.jsxs("li",{children:["Click ",e.jsx("span",{className:"font-semibold",children:'"Save"'})]}),e.jsx("li",{children:"Start chatting with your knowledge base! 🎉"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-blue-300 mb-2",children:"Alternative URLs:"}),e.jsx("div",{className:"space-y-2",children:B().map((l,v)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(l,`alt-${v}`),className:"p-1 hover:bg-blue-700 rounded transition-colors",title:"Copy URL",children:A[`alt-${v}`]?e.jsx(U,{className:"w-3 h-3 text-blue-300"}):e.jsx(X,{className:"w-3 h-3 text-blue-400"})}),e.jsx("code",{className:"text-xs text-blue-200",children:l})]},v))})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-800 bg-opacity-30 rounded-lg",children:[e.jsx("h6",{className:"font-semibold text-blue-300 mb-2",children:"💡 Pro Tips:"}),e.jsxs("ul",{className:"text-xs text-blue-200 space-y-1",children:[e.jsx("li",{children:"• The pipeline automatically accesses your processed documents"}),e.jsx("li",{children:"• Use specific questions for better RAG results"}),e.jsx("li",{children:"• Check the Debug Mode setting above for troubleshooting"}),e.jsx("li",{children:"• Alternative URLs work for different network setups"})]})]})]})]})]})}),e.jsx("div",{className:"card bg-yellow-900 bg-opacity-20 border-yellow-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"w-5 h-5 text-yellow-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-yellow-300 mb-3",children:"🔧 Troubleshooting"}),e.jsx("div",{className:"text-sm text-yellow-200 space-y-3",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-yellow-300 mb-1",children:"Common Issues:"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Pipeline not detected:"})," Try alternative URLs"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Connection failed:"})," Check API key matches exactly"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"No responses:"})," Ensure documents are processed"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Domain issues:"})," Use Tailscale hostname instead"]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-yellow-300 mb-1",children:"Quick Diagnostics:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:E,disabled:i,className:"text-xs bg-yellow-800 hover:bg-yellow-700 px-2 py-1 rounded transition-colors disabled:opacity-50 block",children:i?"Testing...":"Test Pipeline Connection"}),e.jsxs("p",{className:"text-xs text-yellow-300",children:["Status: ",j?"✅ Ready":"⚠️ Unknown"]})]})]})]})})]})]})})]})]})},ee=({title:o,status:t,icon:r,description:u})=>{const a=()=>t?"border-green-500 text-green-400":"border-gray-500 text-gray-400",y=()=>typeof t=="boolean"?t?e.jsx(U,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}):t?e.jsx(U,{className:"w-4 h-4"}):e.jsx(F,{className:"w-4 h-4"}),c=()=>typeof t=="boolean"?t?"Enabled":"Disabled":t||"Not Set";return e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-colors ${a()}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:o})]}),y()]}),e.jsx("div",{className:"text-xs opacity-80 mb-1",children:u}),e.jsx("div",{className:"text-sm font-medium",children:c()})]})},H=({label:o,value:t})=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t}),e.jsx("div",{className:"text-sm text-gray-400",children:o})]}),Re=Ee,Fe=({onSettingsChange:o})=>{const{settings:t,updateCategory:r}=K(),u=ye(),[a,y]=p.useState(t.processing),[c,N]=p.useState(null),[i,w]=p.useState({chunk_size:1200,overlap_size:200}),[x,D]=p.useState(!1),[j,P]=p.useState(!1);p.useEffect(()=>{A()},[]),p.useEffect(()=>{y(t.processing),C()},[t.processing]);const A=()=>M(void 0,null,function*(){D(!0);try{const s=yield u.settings.getChunkingSettings();w(s)}catch(s){}finally{D(!1)}}),b=s=>M(void 0,null,function*(){P(!0);try{const g=yield u.settings.updateChunkingSettings(s);w(g),o&&o()}catch(g){}finally{P(!1)}}),d=(s,g)=>{const m=T(S({},a),{[s]:g});y(m),r("processing",m),o()},k=(s,g)=>{const m=T(S({},i),{[s]:g});w(m),clearTimeout(window.chunkingTimeout),window.chunkingTimeout=setTimeout(()=>{b(m)},1e3)},C=()=>{const E=a.enableContextualEmbeddings?.051000000000000004:0,L=5e4/1e6*.13,$=E+L;N({perDocument:$,contextual:E,embedding:L,perMonth:$*100})},I=[{id:"gpt-4o-mini",name:"GPT-4o Mini",description:"Fast and cost-effective, recommended for most use cases",costPer1M:.15,speed:"Fast",quality:"High",recommended:!0},{id:"gpt-4o",name:"GPT-4o",description:"Most capable model with superior reasoning",costPer1M:5,speed:"Medium",quality:"Highest",recommended:!1},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",description:"Legacy model, lower cost but reduced quality",costPer1M:.5,speed:"Very Fast",quality:"Medium",recommended:!1}],O=I.find(s=>s.id===a.contextualModel)||I[0];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(q,{className:"w-6 h-6 text-primary-400"}),"Processing Configuration"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Configure AI models, contextual embeddings, and processing parameters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(Q,{title:"Contextual AI",value:a.enableContextualEmbeddings?"ON":"OFF",icon:q,status:a.enableContextualEmbeddings,description:"Enhanced document understanding"}),e.jsx(Q,{title:"AI Model",value:O.name,icon:ke,status:!0,description:"Analysis and context generation"}),e.jsx(Q,{title:"Batch Size",value:a.contextBatchSize,icon:Se,status:!0,description:"Concurrent processing chunks"}),e.jsx(Q,{title:"Est. Cost",value:c?`$${c.perDocument.toFixed(3)}`:"...",icon:Te,status:!0,description:"Per document processing"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-primary-400"}),"Contextual Embeddings (v2.0 Feature)"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Generate document-aware summaries for each chunk to improve retrieval accuracy by 35-60%"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.enableContextualEmbeddings,onChange:s=>d("enableContextualEmbeddings",s.target.checked),className:"w-5 h-5 rounded"}),e.jsx("span",{className:"font-medium",children:"Enable Contextual Processing"})]})})]}),a.enableContextualEmbeddings&&e.jsxs("div",{className:"space-y-6 pt-4 border-t border-gray-700",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"font-medium text-gray-300",children:"AI Model for Context Generation"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:I.map(s=>e.jsxs("label",{className:`flex items-center gap-4 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 ${a.contextualModel===s.id?"border-primary-500 bg-primary-600 bg-opacity-10":"border-gray-700 hover:border-gray-600"}`,children:[e.jsx("input",{type:"radio",name:"contextualModel",value:s.id,checked:a.contextualModel===s.id,onChange:g=>d("contextualModel",g.target.value),className:"w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.recommended&&e.jsx("span",{className:"px-2 py-1 bg-green-600 bg-opacity-20 text-green-300 text-xs rounded-full",children:"Recommended"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Cost: $",s.costPer1M,"/1M tokens"]}),e.jsxs("span",{children:["Speed: ",s.speed]}),e.jsxs("span",{children:["Quality: ",s.quality]})]})]})]},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Context Generation Batch Size"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:a.contextBatchSize,onChange:s=>d("contextBatchSize",parseInt(s.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-12 text-center",children:a.contextBatchSize})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Number of chunks to process simultaneously (higher = faster but more expensive)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Processing Timeout (seconds)"}),e.jsx("input",{type:"number",min:"10",max:"300",value:a.processingTimeout/1e3,onChange:s=>d("processingTimeout",parseInt(s.target.value)*1e3),className:"input-primary"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Maximum time to wait for AI processing per batch"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-primary-400"}),"Document Chunking Settings"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Configure how documents are split into chunks for processing (saved to database)"})]}),x&&e.jsx("div",{className:"text-sm text-gray-400",children:"Loading..."}),j&&e.jsxs("div",{className:"text-sm text-yellow-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),"Saving..."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Chunk Size (characters)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"100",max:"5000",step:"100",value:i.chunk_size,onChange:s=>k("chunk_size",parseInt(s.target.value)),className:"flex-1",disabled:x}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-16 text-center",children:i.chunk_size})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Target size for each text chunk (100-5000 chars, recommended: 1200)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Chunk Overlap (characters)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"0",max:Math.max(0,i.chunk_size-100),step:"25",value:i.overlap_size,onChange:s=>k("overlap_size",parseInt(s.target.value)),className:"flex-1",disabled:x}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-16 text-center",children:i.overlap_size})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Character overlap between chunks (0 to ",Math.max(0,i.chunk_size-100),", recommended: 200)"]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-900 bg-opacity-20 rounded-lg border border-blue-700",children:[e.jsxs("div",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"Processing Flow Preview:"})," With current settings, a 10,000 character document will be split into approximately"," ",e.jsx("span",{className:"font-mono bg-blue-800 px-1 rounded",children:Math.ceil(1e4/Math.max(1,i.chunk_size-i.overlap_size))})," ","chunks with"," ",e.jsx("span",{className:"font-mono bg-blue-800 px-1 rounded",children:i.overlap_size})," ","character overlap for context preservation."]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"• Settings apply to new document processing only (existing chunks unchanged) • Changes are automatically saved after 1 second of inactivity • Larger chunks = better context but less precise search results"})]})]}),c&&e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-primary-400"}),"Cost Analysis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-800 bg-opacity-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["$",c.embedding.toFixed(4)]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Embedding Cost"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-800 bg-opacity-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:["$",c.contextual.toFixed(4)]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Contextual Cost"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-800 bg-opacity-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-white",children:["$",c.perDocument.toFixed(4)]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Per Document"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-800 bg-opacity-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:["$",c.perMonth.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Est. Monthly (100 docs)"})]})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsx("p",{children:"• Costs are estimates based on current OpenAI pricing"}),e.jsx("p",{children:"• Contextual embeddings add significant value but increase processing cost"}),e.jsx("p",{children:"• Actual costs depend on document size and complexity"}),e.jsx("p",{children:"• Consider using prompt caching for repeated processing to reduce costs by up to 90%"})]})]}),e.jsx("div",{className:"card bg-yellow-900 bg-opacity-20 border-yellow-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-yellow-400 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-yellow-300 mb-2",children:"Performance Impact"}),e.jsxs("div",{className:"text-sm text-yellow-200 space-y-1",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Contextual Embeddings ON:"})," ~2-3 seconds per chunk, 35-60% better retrieval accuracy"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Contextual Embeddings OFF:"})," ~0.5 seconds per chunk, standard accuracy"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Batch Size:"})," Higher values increase speed but use more API quota simultaneously"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Chunk Size:"})," Larger chunks provide more context but may dilute specific information"]})]})]})]})})]})},Q=({title:o,value:t,icon:r,status:u,description:a})=>{const y=()=>typeof u=="boolean"?u?"border-green-500 text-green-400":"border-gray-500 text-gray-400":"border-blue-500 text-blue-400";return e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-colors ${y()}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(r,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:t})]}),e.jsx("div",{className:"text-sm font-medium mb-1",children:o}),e.jsx("div",{className:"text-xs opacity-80",children:a})]})},Le=Fe,$e=({onSettingsChange:o})=>{var $,z,B;const{settings:t,updateCategory:r,api:u}=K(),[a,y]=p.useState(t.system),[c,N]=p.useState(t.ui),[i,w]=p.useState(null),[x,D]=p.useState(!1),[j,P]=p.useState(!1),[A,b]=p.useState(null),d=p.useRef(null);p.useEffect(()=>{y(t.system),N(t.ui),k()},[t.system,t.ui]);const k=()=>M(void 0,null,function*(){try{const[n,h]=yield Promise.all([u.stats.getDatabase(),u.stats.getHealth()]);w({database:(n==null?void 0:n.stats)||n,health:h,memory:{used:Math.round(Math.random()*512)+256,total:1024},uptime:"2d 14h 32m",version:"2.0.0"})}catch(n){}}),C=(n,h)=>{const l=T(S({},a),{[n]:h});y(l),r("system",l),o()},I=(n,h)=>{const l=T(S({},c),{[n]:h});N(l),r("ui",l),o()},O=()=>M(void 0,null,function*(){D(!0);try{Object.keys(localStorage).filter(h=>h.startsWith("autollama-cache-")||h.startsWith("autollama-search-")).forEach(h=>localStorage.removeItem(h)),yield new Promise(h=>setTimeout(h,1e3)),alert("Cache cleared successfully! The page will refresh."),window.location.reload()}catch(n){alert("Failed to clear cache. Please try again.")}finally{D(!1)}}),s=n=>M(void 0,null,function*(){if(n){if(!n.name.toLowerCase().endsWith(".ico")){b({type:"error",message:"Please select a .ico file"});return}if(n.size>1024*1024){b({type:"error",message:"File size must be under 1MB"});return}P(!0),b(null);try{const h=new FormData;h.append("favicon",n);const v=yield(yield fetch("/api/settings/favicon",{method:"POST",body:h})).json();if(v.success){m();const f=T(S({},c),{customFavicon:!0,faviconUploadTime:new Date().toISOString()});N(f),r("ui",f),b({type:"success",message:"Favicon uploaded successfully!"}),o()}else b({type:"error",message:v.message||"Upload failed"})}catch(h){b({type:"error",message:"Failed to upload favicon"})}finally{P(!1)}}}),g=()=>M(void 0,null,function*(){P(!0),b(null);try{const h=yield(yield fetch("/api/settings/favicon",{method:"DELETE"})).json();if(h.success){E();const l=T(S({},c),{customFavicon:!1,faviconUploadTime:null});N(l),r("ui",l),b({type:"success",message:"Favicon reset to default!"}),o()}else b({type:"error",message:h.message||"Reset failed"})}catch(n){b({type:"error",message:"Failed to reset favicon"})}finally{P(!1)}}),m=()=>{document.querySelectorAll('link[rel*="icon"]').forEach(l=>l.remove());const h=document.createElement("link");h.rel="icon",h.type="image/x-icon",h.href=`/favicon.ico?v=${Date.now()}`,document.head.appendChild(h)},E=()=>{document.querySelectorAll('link[rel*="icon"]').forEach(l=>l.remove());const h=document.createElement("link");h.rel="icon",h.type="image/svg+xml",h.href="/llama-icon.svg",document.head.appendChild(h)},L=n=>{const h=n.target.files[0];h&&s(h),d.current&&(d.current.value="")};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(G,{className:"w-6 h-6 text-primary-400"}),"System Settings"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Configure UI preferences, performance settings, and system behavior"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(V,{title:"Version",value:(i==null?void 0:i.version)||"2.0.0",icon:ce,description:"AutoLlama release"}),e.jsx(V,{title:"Uptime",value:(i==null?void 0:i.uptime)||"Unknown",icon:xe,description:"System running time"}),e.jsx(V,{title:"Memory",value:i?`${i.memory.used}MB`:"Unknown",icon:G,description:i?`of ${i.memory.total}MB`:"Memory usage"}),e.jsx(V,{title:"Debug Mode",value:a.debugLogging?"ON":"OFF",icon:J,description:"Development logging",status:a.debugLogging})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-primary-400"}),"User Interface"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Theme"}),e.jsxs("select",{value:a.theme,onChange:n=>C("theme",n.target.value),className:"input-primary",children:[e.jsx("option",{value:"dark",children:"Dark Mode"}),e.jsx("option",{value:"light",children:"Light Mode"}),e.jsx("option",{value:"auto",children:"Auto (System)"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Choose your preferred theme appearance"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Documents Per Page"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"10",max:"100",step:"10",value:c.documentsPerPage,onChange:n=>I("documentsPerPage",parseInt(n.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-12 text-center",children:c.documentsPerPage})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Number of documents to display per page"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Chunks Per Row"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"5",max:"20",step:"1",value:c.chunksPerRow,onChange:n=>I("chunksPerRow",parseInt(n.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-12 text-center",children:c.chunksPerRow})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Number of chunk cells to display per row in document view"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-300",children:"Display Options"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.showVectorHeatmaps,onChange:n=>I("showVectorHeatmaps",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Show Vector Heatmaps"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.showContextualSummaries,onChange:n=>I("showContextualSummaries",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Show Contextual Summaries"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.animationsEnabled,onChange:n=>I("animationsEnabled",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Enable Animations"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.compactMode,onChange:n=>I("compactMode",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Compact Mode"})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-700",children:[e.jsxs("h5",{className:"font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Custom Favicon"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 bg-gray-800 rounded border border-gray-600 flex items-center justify-center",children:[e.jsx("img",{src:c.customFavicon?`/favicon.ico?v=${c.faviconUploadTime}`:"/llama-icon.svg",alt:"Current favicon",className:"w-4 h-4",onError:n=>{n.target.style.display="none",n.target.nextSibling.style.display="block"}}),e.jsx("div",{style:{display:"none"},className:"w-4 h-4 bg-gray-600 rounded"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-300",children:c.customFavicon?"Custom favicon uploaded":"Using default llama icon"}),c.faviconUploadTime&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Uploaded: ",new Date(c.faviconUploadTime).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",ref:d,onChange:L,accept:".ico",className:"hidden"}),e.jsxs("button",{onClick:()=>{var n;return(n=d.current)==null?void 0:n.click()},disabled:j,className:"btn-secondary flex items-center gap-2 text-xs",children:[j?e.jsx(R,{className:"w-3 h-3 animate-spin"}):e.jsx(te,{className:"w-3 h-3"}),j?"Uploading...":"Upload .ico"]}),c.customFavicon&&e.jsxs("button",{onClick:g,disabled:j,className:"btn-secondary flex items-center gap-2 text-xs",children:[j?e.jsx(R,{className:"w-3 h-3 animate-spin"}):e.jsx(ae,{className:"w-3 h-3"}),"Reset"]})]}),A&&e.jsx("div",{className:`p-2 rounded text-xs ${A.type==="success"?"bg-green-900 border border-green-700 text-green-200":"bg-red-900 border border-red-700 text-red-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[A.type==="success"?e.jsx(U,{className:"w-3 h-3"}):e.jsx(ae,{className:"w-3 h-3"}),A.message]})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload a .ico file (max 1MB) to customize the browser tab icon"})]})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-primary-400"}),"Performance & Caching"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"SSE Update Interval (seconds)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"1",max:"30",value:a.sseUpdateInterval/1e3,onChange:n=>C("sseUpdateInterval",parseInt(n.target.value)*1e3),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-12 text-center",children:[a.sseUpdateInterval/1e3,"s"]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"How often to check for real-time updates"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Cache Timeout (minutes)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"1",max:"60",value:a.cacheTimeout/6e4,onChange:n=>C("cacheTimeout",parseInt(n.target.value)*6e4),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-mono bg-gray-800 px-2 py-1 rounded w-12 text-center",children:[a.cacheTimeout/6e4,"m"]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"How long to cache API responses"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-300",children:"Auto-refresh Options"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.autoRefreshDocuments,onChange:n=>C("autoRefreshDocuments",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Auto-refresh Documents"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.showProcessingDetails,onChange:n=>C("showProcessingDetails",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Show Processing Details"})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("button",{onClick:O,disabled:x,className:"btn-secondary w-full",children:[e.jsx(Ie,{className:`w-4 h-4 ${x?"animate-spin":""}`}),x?"Clearing Cache...":"Clear Application Cache"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Clears stored data and forces a fresh reload"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h4",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary-400"}),"Development & Debugging"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Log Level"}),e.jsxs("select",{value:a.logLevel||"info",onChange:n=>C("logLevel",n.target.value),className:"input-primary",children:[e.jsx("option",{value:"debug",children:"Debug (Verbose)"}),e.jsx("option",{value:"info",children:"Info (Normal)"}),e.jsx("option",{value:"warn",children:"Warning (Important)"}),e.jsx("option",{value:"error",children:"Error (Critical Only)"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Controls console logging verbosity"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.debugLogging,onChange:n=>C("debugLogging",n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Enable Debug Logging"})]}),e.jsx("p",{className:"text-xs text-gray-500 pl-6",children:"Enables detailed logging for troubleshooting"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-yellow-900 bg-opacity-20 rounded-lg border border-yellow-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-yellow-400 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"Debug Mode Active"}),e.jsx("p",{children:"Detailed logs are being written to the browser console. This may impact performance."})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>window.open("/api/logs","_blank"),className:"btn-secondary w-full",children:[e.jsx(me,{className:"w-4 h-4"}),"View System Logs"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Opens server logs in a new window (if available)"})]})]})]})]}),i&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h4",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-primary-400"}),"System Information"]}),e.jsxs("button",{onClick:k,className:"btn-secondary text-xs",children:[e.jsx(R,{className:"w-3 h-3"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-300",children:"Application"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Version:"}),e.jsx("span",{className:"font-mono",children:i.version})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Uptime:"}),e.jsx("span",{className:"font-mono",children:i.uptime})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Environment:"}),e.jsx("span",{className:"font-mono",children:"Production"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-300",children:"Resources"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Memory Usage:"}),e.jsxs("span",{className:"font-mono",children:[i.memory.used,"MB / ",i.memory.total,"MB"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"PostgreSQL Size:"}),e.jsx("span",{className:"font-mono",children:(($=i.database)==null?void 0:$.postgres_size_pretty)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Qdrant Vectors:"}),e.jsx("span",{className:"font-mono",children:(B=(z=i.database)==null?void 0:z.qdrant)!=null&&B.vector_count?`${i.database.qdrant.vector_count.toLocaleString()} (${i.database.qdrant.estimated_size_mb})`:"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cache Size:"}),e.jsx("span",{className:"font-mono",children:"~2.4MB"})]})]})]})]})]})]})},V=({title:o,value:t,icon:r,description:u,status:a})=>{const y=()=>a!==void 0?a?"border-green-500 text-green-400":"border-gray-500 text-gray-400":"border-blue-500 text-blue-400";return e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-colors ${y()}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(r,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:t})]}),e.jsx("div",{className:"text-sm font-medium mb-1",children:o}),e.jsx("div",{className:"text-xs opacity-80",children:u})]})},Oe=$e,ze=()=>{var j,P,A,b;const{setShowSettings:o,settings:t,updateCategory:r,connectionStatus:u}=K(),[a,y]=p.useState("connections"),[c,N]=p.useState(!1),i=[{id:"connections",label:"Connections",icon:de,description:"API keys and database connections",component:oe,badge:u&&Object.values(u).filter(Boolean).length>0?Object.values(u).filter(Boolean).length:null,badgeTotal:6},{id:"pipeline",label:"OpenWebUI",icon:W,description:"RAG pipeline configuration",component:Re,badge:(j=t.pipeline)!=null&&j.debugMode?"🔍":null},{id:"processing",label:"Processing",icon:q,description:"AI models and contextual embeddings",component:Le,badge:(P=t.processing)!=null&&P.enableContextualEmbeddings?"🧠":null},{id:"system",label:"System",icon:G,description:"UI preferences and performance",component:Oe,badge:(A=t.system)!=null&&A.debugLogging?"🐛":null}],w=()=>{c?window.confirm("You have unsaved changes. Are you sure you want to close?")&&(o(!1),N(!1)):o(!1)},x=()=>{N(!1)};p.useEffect(()=>{const d=k=>{k.key==="Escape"?w():k.ctrlKey&&k.key==="s"&&(k.preventDefault(),x())};if(typeof document!="undefined")return document.addEventListener("keydown",d),()=>{typeof document!="undefined"&&document.removeEventListener("keydown",d)}},[c]);const D=((b=i.find(d=>d.id===a))==null?void 0:b.component)||oe;return e.jsx("div",{className:"modal-overlay",onClick:d=>d.target===d.currentTarget&&w(),children:e.jsxs("div",{className:"modal-content w-full max-w-6xl h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-600 bg-opacity-20 rounded-lg flex items-center justify-center",children:e.jsx(Y,{className:"w-5 h-5 text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"AutoLlama Settings"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Configure your digital llama's behavior"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c&&e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Unsaved changes"})]}),e.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",title:"Close (Esc)",children:e.jsx(ae,{className:"w-5 h-5 text-gray-400"})})]})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"w-64 bg-gray-800 bg-opacity-50 border-r border-gray-700 p-4",children:[e.jsx("nav",{className:"space-y-2",children:i.map(d=>{const k=d.icon,C=a===d.id;return e.jsxs("button",{onClick:()=>y(d.id),className:`
                      w-full flex items-center gap-3 p-3 rounded-lg text-left transition-all duration-200
                      ${C?"bg-primary-600 bg-opacity-20 text-primary-400 border border-primary-600 border-opacity-30":"text-gray-400 hover:text-white hover:bg-gray-700 hover:bg-opacity-50"}
                    `,children:[e.jsx(k,{className:"w-5 h-5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:d.label}),d.badge&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${typeof d.badge=="string"?"bg-transparent":C?"bg-primary-800 text-primary-200":"bg-gray-600 text-gray-200"}`,children:typeof d.badge=="number"?`${d.badge}/${d.badgeTotal||d.badge}`:d.badge})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate",children:d.description})]})]},d.id)})}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-700",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-400 mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{icon:Me,label:"Export Settings",onClick:()=>{},className:"text-blue-400 hover:bg-blue-900 hover:bg-opacity-20"}),e.jsx(se,{icon:te,label:"Import Settings",onClick:()=>{},className:"text-green-400 hover:bg-green-900 hover:bg-opacity-20"}),e.jsx(se,{icon:De,label:"Reset to Defaults",onClick:()=>{},className:"text-red-400 hover:bg-red-900 hover:bg-opacity-20"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-6",children:e.jsx(D,{onSettingsChange:()=>N(!0)})})})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-700 bg-gray-800 bg-opacity-30",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsx("span",{children:"AutoLlama v2.3"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:"Use Ctrl+S to save"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:"Press Esc to close"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:w,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:x,className:`btn-primary ${c?"animate-pulse-slow":""}`,disabled:!c,children:c?"Save Changes":"Saved"})]})]})]})})},se=({icon:o,label:t,onClick:r,className:u=""})=>e.jsxs("button",{onClick:r,className:`w-full flex items-center gap-2 p-2 rounded-lg text-sm transition-colors ${u}`,children:[e.jsx(o,{className:"w-4 h-4"}),e.jsx("span",{children:t})]}),He=ze;export{oe as ConnectionsTab,Re as PipelineTab,Le as ProcessingTab,He as SettingsModal,Oe as SystemTab};
