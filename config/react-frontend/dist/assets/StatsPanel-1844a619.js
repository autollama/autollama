var v=(a,t,c)=>new Promise((l,n)=>{var x=i=>{try{d(c.next(i))}catch(m){n(m)}},r=i=>{try{d(c.throw(i))}catch(m){n(m)}},d=i=>i.done?l(i.value):Promise.resolve(i.value).then(x,r);d((c=c.apply(a,t)).next())});import{u as O,j as e}from"./index-3400fd9f.js";import{r as b}from"./vendor-77d0a172.js";import{f as L,R as J,D as T,i as Q,Z,g as z,a3 as K,E as V,a as F,A as G,T as W}from"./icons-212f7396.js";import"./utils-d9662bcb.js";const ce=()=>{var N,w,S,k,D,A,B,C,$,M,R,q;const{api:a,systemStats:t,sse:c,loadSystemStats:l}=O(),[n,x]=b.useState({}),[r,d]=b.useState(!1),[i,m]=b.useState(!1);b.useEffect(()=>{f();const o=setInterval(f,3e4);return()=>clearInterval(o)},[]);const f=()=>v(void 0,null,function*(){try{const[o,h,g]=yield Promise.all([a.stats.getBM25Health().catch(()=>({status:"offline"})),a.stats.getBM25Stats().catch(()=>({total_indices:0})),a.stats.getQdrantActivity().catch(()=>({totalSearches:0}))]);x({bm25:{health:o,stats:h},qdrant:g,lastUpdated:new Date})}catch(o){}}),U=()=>v(void 0,null,function*(){m(!0);try{yield Promise.all([l(),f()])}finally{m(!1)}}),s=(()=>{var E,H,P,_,I;const o={database:((E=t.database)==null?void 0:E.status)==="connected",qdrant:((H=t.knowledgeBase)==null?void 0:H.qdrant_status)==="active",bm25:((_=(P=n.bm25)==null?void 0:P.health)==null?void 0:_.status)==="healthy",api:((I=t.health)==null?void 0:I.status)==="connected"||!0},h=Object.values(o).filter(Boolean).length,g=Object.values(o).length,u=Math.round(h/g*100);return{percentage:u,healthy:h,total:g,status:u===100?"excellent":u>=75?"good":u>=50?"fair":"poor",checks:o}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${s.status==="excellent"?"bg-green-600 bg-opacity-20":s.status==="good"?"bg-blue-600 bg-opacity-20":s.status==="fair"?"bg-yellow-600 bg-opacity-20":"bg-red-600 bg-opacity-20"}`,children:e.jsx(L,{className:`w-5 h-5 ${s.status==="excellent"?"text-green-400":s.status==="good"?"text-blue-400":s.status==="fair"?"text-yellow-400":"text-red-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"System Health"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[s.healthy,"/",s.total," services operational"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-2xl font-bold ${s.status==="excellent"?"text-green-400":s.status==="good"?"text-blue-400":s.status==="fair"?"text-yellow-400":"text-red-400"}`,children:[s.percentage,"%"]}),e.jsx("button",{onClick:U,disabled:i,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",title:"Refresh Stats",children:e.jsx(J,{className:`w-4 h-4 text-gray-400 ${i?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(j,{icon:T,label:"PostgreSQL",status:s.checks.database,details:((N=t.database)==null?void 0:N.version)||"Unknown"}),e.jsx(j,{icon:Q,label:"Qdrant",status:s.checks.qdrant,details:((w=t.knowledgeBase)==null?void 0:w.total_documents)||0}),e.jsx(j,{icon:Z,label:"BM25 Search",status:s.checks.bm25,details:((k=(S=n.bm25)==null?void 0:S.stats)==null?void 0:k.total_indices)||0}),e.jsx(j,{icon:L,label:"API Service",status:s.checks.api,details:"Operational"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(p,{icon:z,title:"Knowledge Base",value:((D=t.knowledgeBase)==null?void 0:D.total_documents)||0,label:"documents processed",trend:"+12%",trendDirection:"up",details:[{label:"Total Chunks",value:((A=t.knowledgeBase)==null?void 0:A.total_chunks)||0},{label:"Avg. Processing Time",value:"2.3s"},{label:"Storage Used",value:((B=t.database)==null?void 0:B.size)||"Unknown"}]}),e.jsx(p,{icon:Q,title:"Search Activity",value:((C=n.qdrant)==null?void 0:C.totalSearches)||0,label:"total searches",trend:"+5%",trendDirection:"up",details:[{label:"Avg. Response Time",value:"145ms"},{label:"BM25 Indices",value:((M=($=n.bm25)==null?void 0:$.stats)==null?void 0:M.total_indices)||0},{label:"Last Activity",value:X((R=n.qdrant)==null?void 0:R.lastSearchActivity)}]}),e.jsx(p,{icon:K,title:"Processing",value:((q=t.database)==null?void 0:q.connections)||0,label:"active connections",trend:"stable",details:[{label:"Queue Length",value:0},{label:"Success Rate",value:"98.5%"},{label:"Contextual Embeddings",value:"Enabled"}]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("button",{onClick:()=>d(!r),className:"w-full flex items-center justify-between p-4 hover:bg-gray-700 hover:bg-opacity-30 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"Detailed System Information"})]}),e.jsx("div",{className:`transform transition-transform ${r?"rotate-180":""}`,children:"â–¼"})]}),r&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700 space-y-4",children:[e.jsx(y,{title:"Database Statistics",data:t.database}),e.jsx(y,{title:"Qdrant Vector Database",data:t.knowledgeBase}),e.jsx(y,{title:"BM25 Search Service",data:n.bm25})]})]})]})},j=({icon:a,label:t,status:c,details:l})=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800 bg-opacity-30 rounded-lg",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${c?"bg-green-600 bg-opacity-20":"bg-red-600 bg-opacity-20"}`,children:e.jsx(a,{className:`w-4 h-4 ${c?"text-green-400":"text-red-400"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:t}),c?e.jsx(F,{className:"w-3 h-3 text-green-400"}):e.jsx(G,{className:"w-3 h-3 text-red-400"})]}),e.jsx("div",{className:"text-xs text-gray-400 truncate",children:l})]})]}),p=({icon:a,title:t,value:c,label:l,trend:n,trendDirection:x,details:r})=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-600 bg-opacity-20 rounded-lg flex items-center justify-center",children:e.jsx(a,{className:"w-5 h-5 text-primary-400"})}),e.jsx("h3",{className:"font-bold",children:t})]}),n&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${x==="up"?"text-green-400":x==="down"?"text-red-400":"text-gray-400"}`,children:[x==="up"&&e.jsx(W,{className:"w-3 h-3"}),e.jsx("span",{children:n})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:c}),e.jsx("div",{className:"text-sm text-gray-400",children:l})]}),r&&e.jsx("div",{className:"space-y-2 text-sm",children:r.map((d,i)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:d.label}),e.jsx("span",{className:"text-gray-300",children:d.value})]},i))})]}),y=({title:a,data:t})=>e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg mb-3 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-primary-400"}),a]}),e.jsx("div",{className:"bg-gray-800 bg-opacity-30 rounded-lg p-4",children:e.jsx("pre",{className:"text-xs text-gray-300 font-mono overflow-x-auto",children:JSON.stringify(t,null,2)})})]}),X=a=>{if(!a)return"None";const t=new Date(a),l=new Date-t;return l<6e4?"Just now":l<36e5?`${Math.floor(l/6e4)}m ago`:l<864e5?`${Math.floor(l/36e5)}h ago`:t.toLocaleDateString()};export{ce as default};
