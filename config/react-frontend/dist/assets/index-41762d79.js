var $=(o,x,c)=>new Promise((d,p)=>{var u=f=>{try{h(c.next(f))}catch(j){p(j)}},m=f=>{try{h(c.throw(f))}catch(j){p(j)}},h=f=>f.done?d(f.value):Promise.resolve(f.value).then(u,m);h((c=c.apply(o,x)).next())});import{u as U,j as e,_ as M}from"./index-220525ce.js";import{r}from"./vendor-146ef102.js";import{C as H,L as Y,b as W,A as J,F as I,c as K,B as Q,G as X,U as Z,d as z,e as V,f as ee}from"./icons-521df13f.js";import"./utils-d9662bcb.js";const F=()=>{const{documents:o,handleDocumentSelect:x,settings:c,newlyCreatedDocumentIds:d,clearNewlyCreatedFlag:p}=U(),[u,m]=r.useState([]),[h,f]=r.useState(new Set),[j,_]=r.useState(new Set),[R,l]=r.useState(new Set),[T,k]=r.useState(new Set);r.useRef([]);const y=r.useRef(new Map),P=r.useRef(null),a={queued:{bg:"bg-gray-700",text:"text-gray-300",border:"border-gray-600",icon:H,pulse:!1},processing:{bg:"bg-yellow-900",text:"text-yellow-300",border:"border-yellow-700",icon:Y,pulse:!0},completed:{bg:"bg-gray-700",text:"text-blue-300",border:"border-gray-600",icon:W,pulse:!1},error:{bg:"bg-red-900",text:"text-red-300",border:"border-red-700",icon:J,pulse:!1}};r.useEffect(()=>{const t=new Set;if(o.forEach(s=>{[s.id,s.url,s.title,s.url&&decodeURIComponent(s.url),s.title&&s.title.substring(0,50)].filter(Boolean).some(w=>d.has(w))&&t.add(s.id)}),d.size>0&&t.size===0){const s=setTimeout(()=>{m(N=>[...N])},500);return()=>clearTimeout(s)}if(t.size>0){t.forEach(i=>{y.current.has(i)&&(clearTimeout(y.current.get(i)),y.current.delete(i))});const s=new Set(o.filter(i=>!t.has(i.id)).map(i=>i.id));f(t),_(s);const N=setTimeout(()=>{f(new Set),_(new Set),l(t);const i=setTimeout(()=>{l(new Set),k(t);const w=setTimeout(()=>{k(b=>{const n=new Set(b);return t.forEach(C=>n.delete(C)),n}),t.forEach(b=>{y.current.delete(b);const n=o.find(C=>C.id===b);n&&[n.id,n.url,n.title,n.url&&decodeURIComponent(n.url),n.title&&n.title.substring(0,50)].filter(Boolean).forEach(A=>{p(A)})})},1e3);t.forEach(b=>{y.current.set(b,w)})},1900);t.forEach(w=>{y.current.set(w,i)})},600);t.forEach(i=>{y.current.set(i,N)})}m(o)},[o,d,p]),r.useEffect(()=>()=>{y.current.forEach(t=>clearTimeout(t)),y.current.clear()},[]);const g=t=>({pdf:I,url:K,file:I,book:Q,article:I,academic:X,reference:Q})[t]||I,S=t=>t.title||t.url||"Untitled Document",D=t=>t.processingProgress?`${Math.round(t.processingProgress.percentage||0)}%`:"";return u.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-8xl mb-4",children:"🦙"}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"No Documents Yet"}),e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"Your digital pasture is empty! Upload some content to get started."}),e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[e.jsx("p",{children:"• Upload PDFs, documents, or paste URLs"}),e.jsx("p",{children:"• AI will analyze and create contextual embeddings"}),e.jsx("p",{children:"• Search and chat with your processed content"})]})]})}):e.jsx("div",{className:"space-y-6",children:e.jsx("div",{ref:P,className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",style:{alignItems:"flex-start"},children:u.map((t,v)=>{const s=a[t.processingStatus]||a.queued,N=g(t.contentType),i=s.icon,w=t.chunkCount||0,b=S(t),n=D(t),C=h.has(t.id),A=j.has(t.id),L=R.has(t.id),B=T.has(t.id),G=(C||L||B)&&t.processingStatus==="completed";return e.jsxs("div",{onClick:()=>x(t),className:`
                document-block relative overflow-hidden rounded-lg border-2 cursor-pointer p-3
                transition-all duration-300 hover:shadow-lg hover:shadow-primary-500/20
                ${s.bg} ${s.border} ${s.pulse?"animate-processing":""}
                ${C?"animate-slide-in-from-left":""}
                ${A?"animate-shift-right":""}
                ${L?"animate-highlight-new":""}
                ${B?"animate-fade-to-normal":""}
                ${G?"animate-mempool-glow":""}
                h-40 sm:h-44 md:h-48 flex-shrink-0
              `,title:`${b} - ${t.processingStatus}`,style:{"--normal-border":s.border.includes("gray-600")?"#4b5563":s.border.includes("yellow-700")?"#a16207":s.border.includes("green-700")?"#15803d":s.border.includes("red-700")?"#b91c1c":"#4b5563","--normal-bg":s.bg.includes("gray-700")?"#374151":s.bg.includes("yellow-900")?"#451a03":s.bg.includes("green-900")?"#14532d":s.bg.includes("red-900")?"#450a0a":"#374151"},children:[e.jsx("div",{className:"absolute inset-0 opacity-5",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white to-transparent"})}),e.jsxs("div",{className:"relative h-full flex flex-col justify-between",children:[e.jsxs("div",{className:"flex items-start justify-between gap-1 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:[e.jsx(N,{className:"w-4 h-4 text-primary-400 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-white truncate text-xs",children:b})]}),e.jsx(i,{className:`w-3 h-3 flex-shrink-0 ${s.text}`})]}),e.jsxs("div",{className:"space-y-1 flex-1",children:[t.summary&&e.jsx("p",{className:"text-xs text-gray-400 line-clamp-4",children:t.summary}),t.mainTopics&&t.mainTopics.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.mainTopics.slice(0,2).map((O,q)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-primary-600 bg-opacity-20 text-primary-300 text-xs rounded-full",children:O},q)),t.mainTopics.length>2&&e.jsxs("span",{className:"px-1.5 py-0.5 text-gray-400 text-xs",children:["+",t.mainTopics.length-2]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-1 border-t border-gray-600 border-opacity-30",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`text-xs font-medium ${s.text}`,children:t.processingStatus==="error"?"Error":`${w}`}),n&&e.jsx("span",{className:"text-xs text-gray-400",children:n})]}),t.usesContextualEmbedding&&e.jsx("div",{className:"flex items-center",title:"Uses Contextual Embeddings",children:e.jsx("span",{className:"text-xs font-bold text-green-400",children:"🧠"})})]}),t.processingStatus==="processing"&&t.processingProgress&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-700",children:e.jsx("div",{className:"h-full bg-yellow-400 transition-all duration-300",style:{width:`${t.processingProgress.percentage||0}%`}})})]})]},t.id||v)})})})},te=r.lazy(()=>M(()=>import("./ProcessingQueue-1b99004b.js"),["assets/ProcessingQueue-1b99004b.js","assets/index-220525ce.js","assets/vendor-146ef102.js","assets/utils-d9662bcb.js","assets/icons-521df13f.js","assets/index-876374cf.css"])),se=r.lazy(()=>M(()=>import("./StatsPanel-42592b09.js"),["assets/StatsPanel-42592b09.js","assets/index-220525ce.js","assets/vendor-146ef102.js","assets/utils-d9662bcb.js","assets/icons-521df13f.js","assets/index-876374cf.css"])),ce=()=>{var y,P;const[o,x]=r.useState("documents"),[c,d]=r.useState([]),{documents:p,systemStats:u,sse:m,uploadQueue:h,api:f,loadSystemStats:j,refreshDocuments:_}=U();r.useEffect(()=>{var t;const a=()=>$(void 0,null,function*(){try{const v=yield f.data.getInProgress();d(v||[])}catch(v){d([])}});a();const g=h.length>0||((t=u.processing)==null?void 0:t.totalProcessing)>0,D=setInterval(()=>$(void 0,null,function*(){yield a(),g&&(yield j())}),g?3e3:8e3);return()=>clearInterval(D)},[f,h.length,(y=u.processing)==null?void 0:y.totalProcessing,j]),r.useEffect(()=>{if(!(m!=null&&m.lastMessage))return;const a=m.lastMessage,g=a.type||a.step;(g==="processing_complete"||g==="file_processing_complete"||g==="session_complete"||g==="document_created"||g==="content_processed")&&(j(),setTimeout(()=>{j()},1e3))},[m==null?void 0:m.lastMessage,j]);const l=(()=>{var i,w,b;const a=((i=u.knowledgeBase)==null?void 0:i.total_documents)||0,g=p.filter(n=>n.processingStatus==="processing").length,S=p.filter(n=>n.processingStatus==="completed").length,D=((w=u.knowledgeBase)==null?void 0:w.total_chunks)||0,t={total:h.length,pending:h.filter(n=>n.status==="pending").length,processing:h.filter(n=>n.status==="processing"||n.status==="uploading").length,completed:h.filter(n=>n.status==="completed").length,failed:h.filter(n=>n.status==="error").length},v=c.filter(n=>n.status==="processing").length,s=t.processing>0&&v===0?t.processing:0,N=Math.max(v,s);return{totalDocs:a,processingDocs:g,completedDocs:S,totalChunks:D,contextualDocs:((b=u.knowledgeBase)==null?void 0:b.contextual_count)||0,uploadQueue:t,totalProcessingCount:N,apiProcessingCount:v}})(),T=[{id:"documents",label:"Documents",icon:z,badge:l.totalDocs,component:F},{id:"processing",label:"Processing",icon:ee,badge:l.totalProcessingCount>0?l.totalProcessingCount:null,component:te},{id:"analytics",label:"Analytics",icon:V,badge:null,component:se}],k=((P=T.find(a=>a.id===o))==null?void 0:P.component)||F;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(E,{label:"Total Documents",value:l.totalDocs,icon:"📚",trend:l.totalDocs>0?"+":""}),e.jsx(E,{label:"Processing Queue",value:l.totalProcessingCount,icon:"⚡",trend:l.totalProcessingCount>0?"active":"empty",pulsing:l.totalProcessingCount>0}),e.jsx(E,{label:"Total Chunks",value:l.totalChunks,icon:"✂️",trend:l.totalChunks>0?"ready":""}),e.jsx(E,{label:"Contextual AI",value:l.contextualDocs,icon:"🧠",trend:l.contextualDocs>0?"enhanced":""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center bg-gray-800 bg-opacity-50 rounded-lg p-1",children:T.map(a=>{const g=a.icon,S=o===a.id;return e.jsxs("button",{onClick:()=>x(a.id),className:`
                  flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200
                  ${S?"bg-primary-600 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}
                `,children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:a.label}),a.badge!==null&&a.badge>0&&e.jsx("span",{className:`
                    px-2 py-1 text-xs rounded-full font-bold
                    ${S?"bg-primary-800 text-primary-200":"bg-gray-600 text-gray-200"}
                  `,children:a.badge})]},a.id)})}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-gray-400",children:"System Online"})]}),u.lastUpdated&&e.jsxs("div",{className:"text-gray-500",children:["Updated ",u.lastUpdated.toLocaleTimeString()]})]})]}),e.jsx("div",{className:"min-h-[500px]",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-400",children:"Loading..."})]})}),children:e.jsx(k,{})})}),e.jsx(ne,{setActiveTab:x})]})},E=({label:o,value:x,icon:c,trend:d,pulsing:p})=>e.jsx("div",{className:`card p-4 transition-all duration-300 ${p?"animate-pulse-slow ring-2 ring-primary-500 ring-opacity-50":""}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:x}),e.jsx("div",{className:"text-sm text-gray-400",children:o}),d&&e.jsx("div",{className:"text-xs text-primary-400 mt-1",children:d})]}),e.jsx("div",{className:`text-2xl transition-opacity duration-300 ${p?"opacity-80":"opacity-50"}`,children:c})]})}),ne=({setActiveTab:o})=>{const[x,c]=r.useState(!1),{setCurrentView:d}=U(),p=()=>{d("processing"),c(!1)},u=()=>{d("processing"),c(!1)},m=()=>{o("analytics"),c(!1)};return e.jsxs("div",{className:"fixed bottom-6 right-6 z-40",children:[x&&e.jsxs("div",{className:"absolute bottom-16 right-0 bg-gray-800 rounded-lg shadow-2xl border border-gray-700 p-2 space-y-2 min-w-[200px]",children:[e.jsxs("button",{onClick:p,className:"w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx(Z,{className:"w-4 h-4 text-primary-400"}),e.jsx("span",{children:"Upload Files"})]}),e.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx(z,{className:"w-4 h-4 text-primary-400"}),e.jsx("span",{children:"Process URL"})]}),e.jsxs("button",{onClick:m,className:"w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx(V,{className:"w-4 h-4 text-primary-400"}),e.jsx("span",{children:"View Analytics"})]})]}),e.jsx("button",{onClick:()=>c(!x),className:`
          w-14 h-14 bg-primary-600 hover:bg-primary-500 rounded-full shadow-lg 
          flex items-center justify-center transition-all duration-300 group
          ${x?"rotate-45":"hover:scale-110"}
        `,children:e.jsx("div",{className:"text-2xl group-hover:scale-110 transition-transform",children:x?"✕":"🦙"})})]})};export{ce as default};
